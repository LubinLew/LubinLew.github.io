# CVE-2020-10204

## 简介

Nexus Repository Manager OSS/PRo <=3.21.1，需有管理员账号

| 项目   | 值                     | 补充               |
| ---- | --------------------- | ---------------- |
| 危害等级 | 高危                    |                  |
| 攻击类别 | Remote Code Execution | JavaEL Injection |
| 攻击位置 | 请求体                   |                  |

## 环境搭建

```bash
# 下载有问题版本的docker
docker pull sonatype/nexus3:3.21.1

# 运行 Nexus
docker run -d -p 8081:8081 --name nexus sonatype/nexus3:3.21.1

# 获取 admin 密码(/nexus-data/admin.password)
docker exec -it `docker ps|grep nexus|awk '{print $1}'` cat /nexus-data/admin.password
```

nexus 成功运行后，登录8081端口 admin 登录， 按照设置向导，修改密码等。

## 问题再现

- admin登录后，抓取请求头中 `NX-ANTI-CSRF-TOKEN` 和 `Cookie` 字段。
- [POC文件](https://github.com/shadowsock5/Poc/blob/master/Nexus/Nexus_CVE_2020_10204.py)

## 

## 参考链接

https://github.com/magicming200/CVE-2020-10199_CVE-2020-10204

https://www.cnblogs.com/magic-zero/p/12641068.html

# CVE-2018-16621

## 简介

Nexus Repository Manager OSS/Pro <=3.13.0，需有管理员账号

| 项目   | 值                     | 补充               |
| ---- | --------------------- | ---------------- |
| 危害等级 | 中危                    |                  |
| 攻击类别 | Remote Code Execution | JavaEL Injection |
| 攻击位置 | 请求体                   |                  |

## 环境搭建

```bash
# 下载有问题版本的docker
docker pull sonatype/nexus3:3.13.0

# 运行 Nexus
docker run -d -p 8081:8081 --name nexus sonatype/nexus3:3.13.0
```

nexus 成功运行后，HTTP连接8081端口， 使用 `admin`/`admin123` 登录。

## 问题再现

- admin登录后，抓取请求头中 `NX-ANTI-CSRF-TOKEN` 和 `Cookie` 字段。
- [POC文件](https://github.com/shadowsock5/Poc/blob/master/Nexus/Nexus_CVE_2018_16621.py)

## 参考链接

[CVE-2018-16621 Nexus Repository Manager3 任意EL表达式注入](https://github.com/Cryin/Paper/blob/master/CVE-2018-16621%20Nexus%20Repository%20Manager3%20%E4%BB%BB%E6%84%8FEL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B3%A8%E5%85%A5.md)

# PSK

第1步，客户端发送 `ClientHello` 消息，该消息主要包括客户端支持的协议版本、会话ID、密码套件、压缩算法、以及扩展消息（`密钥共享`、预共享密钥、预共享密钥模式）；

第2步，服务端回复 `ServerHello`，包含选定的加密套件；发送证书给客户端；使用证书对应的私钥对握手消息签名，将结果发送给客户端；选用客户端提供的参数生成临时公钥，结合选定的参数计算出用于加密 HTTP 消息的`共享密钥`；服务端生成的临时公钥通过 `key_share` 消息发送给客户端；

第3步，客户端接收到 `key_share` 消息后，使用证书公钥进行签名验证，获取服务器端的临时公钥，生成会话所需要的`共享密钥`；

第4步，双方使用生成的共享密钥对消息加密传输，保证消息安全。




## Reference 

https://blog.csdn.net/mrpre/article/details/81532469
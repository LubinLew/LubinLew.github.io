# RSA 密钥交换算法

RSA密钥交换的过程十分直截了当。客户端生成`预主密钥`（46字节随机数），使用服务器公钥对其加密，将其包含在 `ClientKeyExchange` 消息中发送出去。服务器只需要用私钥解密这条消息就能取出预主密钥。

因为RSA算法可以同时用于加密和数字签名，所以RSA密钥交换可以按照这种方式工作。其他流行的密钥类型，比如DSA（DSS）和ECDSA，只能用于签名。

RSA密钥交换的简单性也是它最大的弱点。用于加密`预主密钥`的服务器公钥，一般会保持多年不变。任何能够接触到对应私钥的人都可以恢复`预主密钥`，并构建相同的`主密钥`，从而危害到会话安全性。

对目标的攻击并不需要实时进行，强大的对手可以制定长期行动。攻击者会记录所有的加密的流量，耐心等待有朝一日可以得到密钥。比如计算机能力的进步使暴力破解成为可能；也可以通过法律强制力、政治高压、贿赂或强行进入使用该密钥的服务器来取得密钥。只要密钥泄露，就可以解密之前记录的所有流量了。

TLS中其他常见的密钥交换方式都不受这个问题的影响，被称为支持前向保密。使用那些密钥交换时，每个连接使用的主密钥互相独立。泄露的服务器密钥可以用于冒充服务器，但不能用于追溯任何流量。